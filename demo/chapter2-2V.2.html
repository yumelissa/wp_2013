<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5" />
<title>Little Prince chapter2</title>
</head>

<body class="color_change" style="overflow-x:hidden;">
<div style="height:2000px;"></div>

<div id="grow_div" style="height:1000px; position:relative; z-index:-2;">
<div id="text" style="position:absolute; z-index:6; width:300px; margin-left:850px; margin-top:100px; font-size:16px; line-height:1.5; opacity:1;">
	<div id="text_rose" style="position:relative"><p>And the little prince, completely abashed, went to look for a sprinkling-can of fresh water. So, he tended the flower. So, too, she began very quickly to torment him with her vanity — which was, if the truth be known, a little difficult to deal with. One day, for instance, when she was speaking of her four thorns, she said to the little prince:
	"Let the tigers come with their claws!"
	</p></div>
	<div id="text_screen" style="position:relative"><p>"There are no tigers on my planet," the little prince objected. "And, anyway, tigers do not eat weeds."
	"I am not a weed," the flower replied, sweetly.
	"Please excuse me..."
	"I am not at all afraid of tigers," she went on, "but I have a horror of drafts. I suppose you wouldn't have a screen for me?"</p></div>
	<div id="text_cap" style="position:relative"><p>"A horror of drafts — that is bad luck, for a plant," remarked the little prince, and added to himself, "This flower is a very complex creature..."
	"At night I want you to put me under a glass globe. It is very cold where you live. In the place I came from — "
	But she interrupted herself at that point. She had come in the form of a seed. She could not have known anything of any other worlds. Embarrassed over having let herself be caught on the verge of such a naive untruth, she coughed two or three times, in order to put the little prince in the wrong.
	"The screen?"
	"I was just going to look for it when you spoke to me..."
	Then she forced her cough a little more so that he should suffer from remorse just the same. So the little prince, in spite of all the good will that was inseparable from his love, had soon come to doubt her. He had taken seriously words which were without importance, and it made him very unhappy.
	</p></div>
</div>
<img src="pic/waterfall.png"  style="z-index:2; position:absolute; top:-200px; left:2000px; width:120px; height:80px; margin-left:350px" id="waterfall" />
<img id="screen" src="pic/screen.png" style="z-index:3; position:absolute; top:-200px; left:2000px; width:200px; height:180px; margin-left:500px; margin-top:270px; transform:rotate(15deg); -webkit-transform:rotate(15deg);" />
<img src="pic/rose.png" style="width:120px; height:200px; margin-left:450px; margin-top:200px; z-index:5; position:absolute;" id="rose"/>
<img src="pic/earth_norose.png" style="width:700px; height:700px; top:50px;  position:absolute; z-index:-1; margin-top:250px; margin-left:150px" id="earth_big"/ >
</div>

<div id="pic_div" style="height:600px; position:relative; z-index:-2;">
<div class="man_walk" style="background-image:url(pic/prcclean1.png); background-repeat:no-repeat; background-size:120px 210px; z-index:1; width:120px; height:210px; margin-top:50px; margin-left:260px; position:absolute"></div>
<img src="pic/earth.png" style="width:400px; height:400px; top:50px;  position:absolute; z-index:-1; margin:150px" id="earth"/ >
</div>

<div style="height:1000px">
<!--<img src="file:///C|/Users/asus/Documents/Web程式設計/pic/rose.jpg" id="rose-2" style=" z-index:1; width:300px; height:300px; position:absolute;">
<img src="file:///C|/Users/asus/Documents/Web程式設計/pic/rose.jpg" id="rose" style=" z-index:2; width:300px; height:300px; position:absolute;">
<img src="file:///C|/Users/asus/Documents/Web程式設計/pic/rose.jpg" id="rose-3" style=" z-index:3; width:300px; height:300px; position:absolute;">-->
</div>


<script src="jquery.min.js"></script>
<script src="jquery.superscrollorama.js"></script>
<script src="TweenMax.min.js"></script>
<script type="text/javascript">
	$(document).ready(function() {
		//$('body').scrollTop(0);
		$('#text_rose').hide();
		$('#text_screen').hide();
		$('#text_cap').hide();
		var controller = $.superscrollorama({
			triggerAtCenter: false,
			playoutAnimations: true
		});
	// controller.addTween('#fade',
    //	 TweenMax.to($('#fade'), 1, {css:{opacity:0}}),500);
		
		// parallax example
	//controller.addTween(
//	  '#examples-parallax',
//	  (new TimelineLite())
//	    .append([
//	      TweenMax.fromTo($('#parallax-it-left'), 2, 
//	        {css:{top: 100}, immediateRender:true}, 
//	        {css:{top: -400}}),
//	      TweenMax.fromTo($('#parallax-it-right'), 1, 
//	        {css:{top: 50}, immediateRender:true}, 
//	        {css:{top: -900}})
//	    ]),
//	  500 // scroll duration of tween
//	); 
	
		//controller.pin($('#color_div'), pinDur, {
//		anim:pinAnimations, 
//		onPin: function() {
//		$('#color_div').css('height','100%');
//			}, 
//		onUnpin: function() {
//		$('#color_div').css('height','1000px');
//			} 
//		});
	//背景顏色改變			
					//var pinDur = 100;
//					var pinAnimations = new TimelineLite();
//					
//					pinAnimations
//						.append([
//							TweenMax.to($('.color_change'), 10, {css:{backgroundColor:'#FFFFFF'}},.2)
//								])
//						.append([
//							TweenMax.to($('.color_change'), 10, {css:{backgroundColor:'#FFFFCC'}},.2)
//								])
//						.append([
//							TweenMax.to($('.color_change'), 10, {css:{backgroundColor:'#FFFF99'}},.2)
//								]);
					
					//地球旋轉
					controller.pin($('#pic_div'),1000,{
						anim: (new TimelineLite())
						.append(
							TweenMax.fromTo($('#earth'), 20, 
							{css:{rotation: -360}, immediateRender:true}, 
							{css:{rotation: 360}})
										)
					});
	
	});
	

	// keep walking
	var images=['pic/prcclean2.png','pic/prcclean1.png'];
	var i=0;
	
	function walk(){
		$('.man_walk').css('background-image',function(){
			if(i>=images.length){
				i=0;
				var j=-20*i;
			}
			return 'url('+images[i++]+')';
		});
	}
	walk();
	setInterval(walk, 300);
	var rose_textshow=function(){
		$('#text_rose').show();
		$('#text_screen').hide();
		$('#text_cap').hide();
	};
	var screen_textshow=function(){
		$('#text_rose').hide();
		$('#text_screen').show();
		$('#text_cap').hide();
	};
	
	$(window).scroll(function()
	{
		var wintop=$(window).scrollTop(), docheight = $(document).height(), winheight = $(window).height();
		//var  scrolltrigger = 100;
		//var waterheight=$('#waterfall').height();
		//var x=winheight/docheight;
		var position=$('#grow_div').position();
		console.log('wintop='+wintop);
    	console.log('docheight='+docheight);
    	console.log('winheight='+winheight);
		console.log('grow_div='+position.top);
		
		//灑水if
		if(position.top<=2008 && wintop>1800 && wintop<1880) 
		{
			//$('#waterfall').addClass("animated rotateInDownRight");
			(new TimelineLite({onComplete:initScrollAnimations}))
				.to( $('#waterfall'), 1, {css:{opacity:.99, 'margin-top':0, left:'2000px', top:'-200px'}, delay:1, ease:Elastic.easeOut});
			//$('#waterfall').css({'[visibility]':'[visible]'});
			$('#waterfall').hide();
			
		}
		//灑具進來
		else if(position.top==2008 && wintop>1880 && wintop<1950)
		{
			$('#waterfall').show();
			function initScrollAnimations() {
					$('#grow_div').css('display','block');
					var controller = $.superscrollorama();			
					// title tweens								
						controller.addTween(5, TweenMax.to('#waterfall', 2, {css:{top: 0, left: 0, rotation:-1080,}, ease:Quad.easeOut}));				
						//controller.addTween(5, TweenMax.to('#waterfall', .5, {css:{top: -600, left: -800, rotation:720-360}, ease:Quad.easeOut}));
							};
			initScrollAnimations();
			console.log('XXXX');
			rose_textshow();
					
		}
		//澆花
		else if(position.top==2008 && wintop>1950 && wintop<2220)
		{
			//$('#waterfall').css({'[transform]':'[rotate(20deg)]'});
			
			 $('#waterfall').css("transform","rotate(-20deg)");
             $('#waterfall').css("-webkit-transform","rotate(-20deg)"); //給Chrome看的css
			console.log('YYY');
			rose_textshow();
					
		}
		//灑具離開
		else if(position.top===2008 && wintop>2220 && wintop<2350)
		{
			function initScrollAnimations() {
				var controller = $.superscrollorama();	
				controller.pin($('#grow_div'),300, {
						anim: (new TimelineLite())
							.append(
								TweenMax.fromTo($('#waterfall'), 4, 
									{css:{left:200, top: 100, rotation: -360}, immediateRender:true}, 
									{css:{left:-600, top: -100, rotation: 360}})
									)
					})
			};
			initScrollAnimations();
			rose_textshow();
			//console.log('SSS');
		}
		else
		{
			$('#waterfall').css({'[top]':'[0px]','[left]':'[0px]'});
			$('#waterfall').hide();
		}
		
		
		//屏風if
		if(position.top<=2008 && wintop>2350 && wintop<2450) 
		{
			//$('#waterfall').addClass("animated rotateInDownRight");
			(new TimelineLite({onComplete:initScrollAnimations}))
				.to( $('#screen'), 1, {css:{opacity:.99, 'margin-top':0, left:'2000px', top:'-200px'}, delay:1, ease:Elastic.easeOut});
			//$('#waterfall').css({'[visibility]':'[visible]'});
			$('#screen').hide();
			
		}
		else if(position.top<=2008 && wintop>2450 && wintop<2550) 
		{
			$('#screen').show();
			function initScrollAnimations_screen() {
					$('#grow_div').css('display','block');
					var controller = $.superscrollorama();			
					// title tweens								
						controller.addTween(5, TweenMax.to('#screen', 2, {css:{top: 0, left: 0, rotation:-360,}, ease:Quad.easeOut}));				
							};
			initScrollAnimations_screen();
			screen_textshow();
		}
			////screen leave
			else if(position.top===0 && wintop>2550 && wintop<2650)
			{
				//if(wintop>2850 && wintop<3250)
				//{
				function initScrollAnimations_screen() {
					var controller = $.superscrollorama();	
					controller.pin($('#grow_div'),300, {
							anim: (new TimelineLite())
								.append(
									TweenMax.fromTo($('#screen'), 4, 
										{css:{left:0, top: 250, rotation: -360}, immediateRender:true}, 
										{css:{left:-1000, top: -300, rotation: 360}})
										)
						})
				};
				initScrollAnimations_screen();
				screen_textshow();

			console.log("x-"+wintop);
			console.log("y-"+position.top);

			}
			else
			{
				$('#screen').hide();
			}
		
		//waterfall();
		//screenmove();
	});

						
</script>
</body>
</html>
